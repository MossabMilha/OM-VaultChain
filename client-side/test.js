import forge from 'node-forge';

const privateKeyPem = `-----BEGIN PRIVATE KEY-----
TUlJRXZnSUJBREFOQmdrcWhraUc5dzBCQVFFRkFBU0NCS2d3Z2dTa0FnRUFBb0lCQVFDOEQ3OXRTZGhJRm1CVFFNTjlPNnMrQ0xjeWkzRVZ6aFg2MmlYcTRyYW5PVmxBa0JkVm1YNjJkYzRIcEtSSVljZCtzRTFWT25sWTdqT1NicE9EU2s4YnkzNEV1QzdrQlFCU1ZxMmVoYUNOakhtNG5LU3hoUHNlaE12VkxpQ2RjU2lJUi9LUEhnK1BUSS91UmJ5T3RIMkJiWTNkV1NDUWo0enQ3NmhaZXpsUUFLdUZCUTVCRlJsQ282L09QWmd0Y085VlJqOHd2UnNuNTZzQ1ZWM3l0MzBhOStHaXpJQnN0d3VWQ3FlMFh3MUFuWS8vZ1BwNHIzU0U4d0VGVUlvRk1xZVgybDBzKzdnNWJydW9wZEdjTGQyQkt6WkZDZE5rU2tEMjhKengxWXdGSUEzSC9hWkJ0QXJKcFNjeVV2SjdjdWlJQTAyQkZpMTQ2Ny9kZnVOb045T3JBZ01CQUFFQ2dnRUFESjFSemRiaU54T3BLbXh4c0hqTUo4RVY2TUlKdDlpM0NMaVJTb3dpakYwQWE2QStzSE0zV0szV1FCVC9JQXZQQWVSNWkzbjhvY1o0bHgzcnJ5YlEzNkJxdDQ1VE51QlBBVGJuTm5ib0toWitJNi8rTEJvcmJnU2lWNDVjaWJNSmNQckNmbThaeEJieW9KejA1TzJlYll3WHMvMUNmZS9qR0NLM1BDbFQwdFhiT0dRR0Yyczg3Vi9NaTh1enlrcW81VWVNUTV2K28xZk8ySlluMFErRWR1ZG5OTTFIUmFJdVFQRG1qU1hPZWlzbjJ3WVFrQnJIOW9DY2FyQU84ZFIvU2VHVDBYbis1Q0Z1TzRXOThSbnFvUFJXcCtyZnJuZ2EyRVE0ZTQ1ekZCWTlHbUJQaTlKeGNsM1phQ29KTVVDTVNCSkV3a2Fxa3FIVGNiQjZ6NzdaSVFLQmdRRGlMVGpSTFQ1WGdDL0t2QldQTkZacmZZN2FRT2ZoZTVEd3IxNVZkdDBmc2tWTWk3SmhWUkpYS2RWUDJudDhOYnVqbDIvdjZycklTdGxQWTRQSWRvdFQrc1ZmWVJiaS9XRy8rVThVQnFXd01teGY4WDVvRWdjaXlmcm9GNnJVNXpWYW9nVm1VZXhoNnNLdE5zQzhSUTJoQ1ArQnc2cHZ2TnNrSkltRkpDdHFQd0tCZ1FEVTIrc1RMbEVIbXdzeGY1K09rRjhMNGZDYmZtQmtWdkRPVlhnTzBaMERXbjc2MzJiQkRHQ3hjUlRDNGtEL09XQU8vTTJEVXRQVERaTloydGViOGE5cUVmZUt4NWhvVkFaU3Y2VmpnUXFqZVROVVZOcG9ya2taQjRMUzZoR2pLMW0rRDRaMnEybTJHZHYzcHd2MXV0WXFWN3VKVWhIRytnRGhaa1VCRTd2RGxRS0JnUURXVzBXZCtlTTd5cUdBNHdFTDErNlBzVS9TU2ZGNklrSWIyaGp0cHRtclVLbWRBa2p0TmxOTGlMcENGQzgwYVRpTXN0bkQ2Qk5lQUpJMFMzeDZZTjlybUIrM1phenJOSG1RR0JoNlFsS0Z5MFFyS2hWRFROSzJoZmJtUUlnSGY1bHhiRnp4dkhMcjJqTG5OeDB6VWI2NUFHNG43ZWw2UE9MMFBpeVhvdEFDd1FLQmdDeVFrb25rZzVCOUZIM2JnM05jcEptZlJ6bTIzc1dETWsxd3RYOGN3YXZIRVpqQ2x3Zko2S0NkMVVQc0RNR2lxSXJhd01oQzJoaHcyaTNRMUoxUW4zSXNxdEFDYzlVNzZrcisxc2liWnJmTkUwTVB0TjUveHN3WHQzc2pDR2hLRmpMbG16aFRNUUd3TGs2T1NjRzd5VVQ2TTBoUHgyc0tRbzd1VTNvalFJZDFBb0dCQUt5VUxjU2FVaWlGR0dWTExxbWdoak43cFRROFlPMXJUK2hjcnVRZEdYaXZsS2xPMHUyQTRxekdTSnNaRTlVMHp5S1NvNVZKZzBvdEFpVGlQUCsvcjBqWmlNNk9WQ21qb3ZDazRDdmZ2UXV6WnFWQzlNSTUycW1UUHc2eE1ZRzBnUm9lK3lib1VrT2pVeXFSSTFtdU9tUTU0S0MrUVJCYkhSZFdlZ2hyRUFPdg
-----END PRIVATE KEY-----`;

const publicKeyPem = `-----BEGIN PUBLIC KEY-----
MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAvA+/bUnYSBZgU0DDfTurPgi3MotxFc4V+tol6uK2pzlZQJAXVZl+tnXOB6SkSGHHfrBNVTp5WO4zkm6Tg0pPG8t+BLgu5AUAUlatnoWgjYx5uJyksYT7HoTL1S4gnXEoiEfyjx4Pj0yP7kW8jrR9gW2N3VkgkI+M7e+oWXs5UACrhQUOQRUZQqOvzj2YLXDvVUY/ML0bJ+erAlVd8rd9GvfhosyAbLcLlQqntF8NQJ2P/4D6eK90hPMBBVCKBTKnl9pdLPu4OW67qKXRnC3dgSs2RQnTZEpA9vCc8dWMBSANx/2mQbQKyaUnMlLye3LoiANNgRYteOu/3X7jaDfTqwIDAQAB
-----END PUBLIC KEY-----`;

const message = 'Hello, RSA!';

// Parse PKCS#8 private key
const privateKey = forge.pki.privateKeyFromPem(privateKeyPem);

// Sign the message
const md = forge.md.sha256.create();
md.update(message, 'utf8');
const signature = privateKey.sign(md);

// Verify the signature
const publicKey = forge.pki.publicKeyFromPem(publicKeyPem);
const verified = publicKey.verify(md.digest().bytes(), signature);

console.log('Signature valid:', verified);